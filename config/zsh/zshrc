#!/usr/bin/env bash
export XDG_CONFIG_HOME="$HOME/.config"

HISTFILE=$XDG_CONFIG_HOME/zsh/histfile
export PATH="$HOME/bin:$PATH"
HISTSIZE=10000000
SAVEHIST=1000000
setopt autocd extendedglob
setopt INC_APPEND_HISTORY
setopt CLOBBER
bindkey -e

# all NVM things from `brew install nvm`
export NVM_DIR="$HOME/.nvm"
nvm_load () {
    [ -s "/usr/local/opt/nvm/nvm.sh" ] && . "/usr/local/opt/nvm/nvm.sh"  # This loads nvm
    [ -s "/usr/local/opt/nvm/etc/bash_completion" ] && . "/usr/local/opt/nvm/etc/bash_completion"  # This loads nvm bash_completion
}
alias node='unalias nvm; unalias node; unalias npm; nvm_load; node'
alias npm='unalias nvm; unalias node; unalias npm; nvm_load; npm'
alias nvm='unalias nvm; unalias node; unalias npm; nvm_load; nvm'

source /usr/local/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
TERM=xterm-256color
if [ -z "$NVIM_LISTEN_ADDRESS" ]; then
    export VISUAL="$(which nvim)"
fi

# fzf
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
export FZF_DEFAULT_OPTS="--ansi --no-height"
export FZF_DEFAULT_COMMAND='rg --files'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_CTRL_T_OPTS="--preview 'bat --color=always {}'"

# lyft
export PROJECT_ROOT="$HOME/src/"
if [ -f ~/.lyftrc  ]; then
    source ~/.lyftrc
fi

. $XDG_CONFIG_HOME/zsh/alias.sh
. $XDG_CONFIG_HOME/zsh/theme.sh
. $XDG_CONFIG_HOME/zsh/functions.sh
. $XDG_CONFIG_HOME/zsh/lyft.sh
source '/Users/mgrossman/src/awsaccess/awsaccess2.sh' # awsaccess
source '/Users/mgrossman/src/awsaccess/oktaawsaccess.sh' # oktaawsaccess
export PS1="\$(ps1_mfa_context)$PS1" # awsaccess
alias runlyft="aws-okta exec zimride-developer -- runlyft"
PATH=$PATH:/Users/mgrossman/.lyftkube-bin
